{"id":"31c2e222-4e7c-463f-9da7-65c8b2c592f7","zed":"context","version":"0.4.0","text":"\n\n\n\n```js pg-press/assets/js/page-tools.js\nvar idToolsFilter = \"#tools-filter\";\nvar idToolsList = \"#tools-list\";\nvar urlSearchParamName = \"tools_filter\";\nvar storageKeyLastActiveTab = \"last-active-tab\";\nvar defaultTabIndex = 1;\n\nfunction filterToolsList(event = null, skipHistory = false) {\n\tvar target;\n\tif (!event) {\n\t\ttarget = document.querySelector(idToolsFilter);\n\t} else {\n\t\ttarget = event.currentTarget;\n\t}\n\n\tif (!target) return;\n\n\tif (!skipHistory) {\n\t\tconst urlParams = new URLSearchParams(window.location.search);\n\t\turlParams.set(urlSearchParamName, target.value);\n\t\twindow.history.replaceState({}, \"\", `?${urlParams.toString()}`);\n\t}\n\n\tvar values = target.value\n\t\t.toLowerCase()\n\t\t.split(\" \")\n\t\t.filter((v) => !!v);\n\n\tvar targets = document.querySelectorAll(`${idToolsList} > .tool-item`);\n\tfor (var child of targets) {\n\t\tvar textContent = child.textContent.toLowerCase();\n\n\t\tvar match = true;\n\t\tfor (var value of values) {\n\t\t\tif (!textContent.includes(value)) {\n\t\t\t\tmatch = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!match) {\n\t\t\tchild.style.display = \"none\";\n\t\t} else {\n\t\t\tchild.style.display = \"block\";\n\t\t}\n\t}\n}\n\nfunction initFilterInputFromQuery() {\n\tconst urlParams = new URLSearchParams(window.location.search);\n\tconst query = urlParams.get(urlSearchParamName);\n\n\tif (query) document.querySelector(idToolsFilter).value = query;\n}\n\nfunction toggleTab(event) {\n\tdocument.querySelectorAll(\".tabs > .tab\").forEach((tab) => {\n\t\ttab.classList.remove(\"active\");\n\t});\n\n\tevent.currentTarget.classList.add(\"active\");\n\tevent.currentTarget.dispatchEvent(new Event(\"loadTabContent\"));\n\n\tlocalStorage.setItem(\n\t\tstorageKeyLastActiveTab,\n\t\tevent.currentTarget.dataset.index,\n\t);\n}\n\n// On document loaded, restore last active tab\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\tvar lastActiveTab = parseInt(localStorage.getItem(storageKeyLastActiveTab));\n\n\tif (!isNaN(lastActiveTab)) {\n\t\tvar tab = document.querySelector(\n\t\t\t`.tabs > .tab[data-index=\"${lastActiveTab}\"]`,\n\t\t);\n\t\tif (tab) {\n\t\t\ttoggleTab({ currentTarget: tab });\n\t\t}\n\t} else {\n\t\ttoggleTab({\n\t\t\tcurrentTarget: document.querySelector(\n\t\t\t\t`.tabs > .tab[data-index=\"${defaultTabIndex}\"]`,\n\t\t\t),\n\t\t});\n\t}\n});\n```\n\nminimize, clean up, restructure \n\nCertainly! Below is a minimized, cleaned-up, and slightly restructured version of your JavaScript code:\n\n```javascript\nconst idToolsFilter = '#tools-filter';\nconst idToolsList = '#tools-list';\nconst urlSearchParamName = 'tools_filter';\nconst storageKeyLastActiveTab = 'last-active-tab';\nconst defaultTabIndex = 1;\n\nfunction filterToolsList(event = null, skipHistory = false) {\n    const target = event ? event.currentTarget : document.querySelector(idToolsFilter);\n    if (!target) return;\n\n    const query = target.value.toLowerCase().split(' ').filter(v => !!v);\n    const targets = document.querySelectorAll(`${idToolsList} > .tool-item`);\n\n    if (!skipHistory) {\n        updateUrlQueryParam(query);\n    }\n\n    targets.forEach(child => {\n        child.style.display = query.every(value => child.textContent.toLowerCase().includes(value)) ? 'block' : 'none';\n    });\n}\n\nfunction initFilterInputFromQuery() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const query = urlParams.get(urlSearchParamName);\n    if (query) document.querySelector(idToolsFilter).value = query;\n}\n\nfunction updateUrlQueryParam(query) {\n    const urlParams = new URLSearchParams(window.location.search);\n    urlParams.set(urlSearchParamName, query.join(' '));\n    window.history.replaceState({}, '', `?${urlParams.toString()}`);\n}\n\nfunction toggleTab(event) {\n    document.querySelectorAll('.tabs > .tab').forEach(tab => tab.classList.remove('active'));\n    event.currentTarget.classList.add('active');\n    event.currentTarget.dispatchEvent(new Event('loadTabContent'));\n\n    localStorage.setItem(storageKeyLastActiveTab, event.currentTarget.dataset.index);\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    let lastActiveTab = parseInt(localStorage.getItem(storageKeyLastActiveTab)) || defaultTabIndex;\n    toggleTab({ currentTarget: document.querySelector(`.tabs > .tab[data-index=\"${lastActiveTab}\"]`) });\n});\n```\n\n### Key Changes:\n1. **Variable Declarations**: Grouped constant declarations at the top for better readability.\n2. **Function Extraction**: Extracted repeated code into helper functions (`filterToolsList`, `initFilterInputFromQuery`, and `updateUrlQueryParam`).\n3. **Simplified Logic**: Simplified some logic to reduce complexity.\n4. **Default Value**: Used logical OR for default value assignment in `toggleTab`.\n\nThis should make the code easier to read and maintain.\n","messages":[{"id":{"replica_id":0,"value":0},"start":0,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":32}}},{"id":{"replica_id":0,"value":26},"start":2208,"metadata":{"role":"assistant","status":"Done","timestamp":{"replica_id":0,"value":33}}},{"id":{"replica_id":0,"value":27},"start":4610,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":34}}}],"summary":"Page Tools Script Optimization","slash_command_output_sections":[{"range":{"start":0,"end":1},"icon":"Library","label":"Default","metadata":null},{"range":{"start":4,"end":2173},"icon":"File","label":"pg-press/assets/js/page-tools.js","metadata":{"path":"pg-press/assets/js/page-tools.js"}}],"thought_process_output_sections":[]}